%YAML 1.1
---
$schema: asdf://stsci.edu/datamodels/roman/schemas/rad_schema-1.0.0
id: asdf://stsci.edu/datamodels/roman/schemas/SSC/CGI/keywords/cgi_exposure-1.0.0

title: Exposure Information
extName: SSC

type: object
properties:
  EXPTIME:
    title: Exposure Time
    description: Exposing stage duration (seconds)
    type: number
    archive_catalog:
      datatype: float
      destination: [CGIExposure.exposure_time, CGIMosaic.exposure_time]
  EMGAIN_C:
    title: Commanded EM gain
    description: Commanded EM gain
    type: number
    archive_catalog:
      datatype: float
      destination: [CGIExposure.emgain_c]
  UNITYG:
    title: DAC value corresponding to unity gain
    description: DAC value corresponding to unity gain (V)
    type: number
    archive_catalog:
      datatype: float
      destination: [CGIExposure.unityg]
  EMGAINA1:
    title: Gain voltage conversion coefficient A1
    description: Gain voltage conversion coefficient A1
    type: number
    archive_catalog:
      datatype: float
      destination: [CGIExposure.emgaina1]
  EMGAINA2:
    title: Gain voltage conversion coefficient A2
    description: Gain voltage conversion coefficient A2
    type: number
    archive_catalog:
      datatype: float
      destination: [CGIExposure.emgaina2]
  EMGAINA3:
    title: Gain voltage conversion coefficient A3
    description: Gain voltage conversion coefficient A3
    type: number
    archive_catalog:
      datatype: float
      destination: [CGIExposure.emgaina3]
  EMGAINA4:
    title: Gain voltage conversion coefficient A4
    description: Gain voltage conversion coefficient A4
    type: number
    archive_catalog:
      datatype: float
      destination: [CGIExposure.emgaina4]
  EMGAINA5:
    title: Gain voltage conversion coefficient A5
    description: Gain voltage conversion coefficient A5
    type: number
    archive_catalog:
      datatype: float
      destination: [CGIExposure.emgaina5]
  GAINTCAL:
    title: Gain temperature  calibration point
    description: Gain temperature  calibration point (degC)
    type: number
    archive_catalog:
      datatype: float
      destination: [CGIExposure.gaintcal]
  EMGAIN_A:
    title: Actual EM gain
    description: Actual EM gain
    type: number
    archive_catalog:
      datatype: float
      destination: [CGIExposure.emgain_a]
  KGAINPAR:
    title: Scaling factor convert DN to electrons (e-/DN)
    description: Scaling factor convert DN to electrons (e-/DN)
    type: number
    archive_catalog:
      datatype: float
      destination: [CGIExposure.kgainpar]
  CYCLES:
    title: EXCAM clock cycles since boot
    description: EXCAM clock cycles since boot (clock cycles)
    type: integer
    archive_catalog:
      datatype: int
      destination: [CGIExposure.cycles]
  LASTEXP:
    title: Clock cycles in last exposure stage of readout
    description: Clock cycles in last exposure stage of readout (clock cycles)
    type: integer
    archive_catalog:
      datatype: int
      destination: [CGIExposure.lastexp]
  BLNKTIME:
    title: Commanded blanking time in seconds
    description: Commanded blanking time (s)
    type: number
    archive_catalog:
      datatype: float
      destination: [CGIExposure.blnktime]
  BLNKCYC:
    title: Commanded blanking time in cycles
    description: Commanded blanking time (clock cycles)
    type: integer
    archive_catalog:
      datatype: int
      destination: [CGIExposure.blnkcyc]
  EXPCYC:
    title: Exposing stage duration
    description: Exposing stage duration (clock cycles)
    type: integer
    archive_catalog:
      datatype: int
      destination: [CGIExposure.expcyc]
  ISPC:
    title: Photon counting flag
    description: Photon counting flag
    type: boolean
    archive_catalog:
      datatype: nchar(1)
      destination: [CGIExposure.ispc]
  FTIMEUTC:
    title: Frame date/time at readout
    description: Frame date/time at readout (s)
    allOf:
      - $ref: http://stsci.edu/schemas/asdf/time/time-1.3.0#/definitions/iso_time
    archive_catalog:
      datatype: datetime2
      destination: [CGIExposure.ftimeutc]
  ARRTYPE:
    title: Type of detector readout
    description: Type of detector readout; SCI=2200x1200 pixels, ENG=2200x2200 pixels
    type: string
    maxLength: 4
    enum:
      - SCI
      - ENG
    archive_catalog:
      datatype: nvarchar(4)
      destination: [CGIExposure.arrtype, CGIMosaic.arrtype]
  HVCBIAS:
    title: HV Clock Bias Voltage
    description: HV Clock Bias Voltage (V)
    type: number
    archive_catalog:
      datatype: float
      destination: [CGIExposure.hvcbias]
  OPMODE:
    title: EXCAM readout operational mode
    description: EXCAM readout operational mode
    type: string
    maxLength: 50
    enum:
      - NONE_DETON_0
      - ACQUIRE_SCIENCE
      - LOWFSC_STRSH
      - TRAP_PUMPING
      - ENGINEERING_EM
      - ENGINEERING_CONV
      - SPARE_1
      - SPARE_2
      - SPARE_3
      - SPARE_4
      - SPARE_5
      - SPARE_6
      - SPARE_7
      - SPARE_8
      - SPARE_9
      - NONE_DETON_15
    archive_catalog:
      datatype: nvarchar(50)
      destination: [CGIExposure.opmode]
  # For both the Roman CGI Search and the MAST Cross-Mission Search, sending these fields will permit time-range-based searches.
  EXPSTART: # SOC Proposed
    title: Start Time
    description: Observation start time (UTC)
    allOf:
      - $ref: http://stsci.edu/schemas/asdf/time/time-1.3.0#/definitions/iso_time
    archive_catalog:
      datatype: datetime2
      destination: [CGIExposure.visit_start_time, CGIMosaic.visit_start_time]
  EXPEND: # SOC Proposed
    title: End Time
    description: Observation end time (UTC)
    allOf:
      - $ref: http://stsci.edu/schemas/asdf/time/time-1.3.0#/definitions/iso_time
    archive_catalog:
      datatype: datetime2
      destination: [CGIExposure.visit_end_time, CGIMosaic.visit_end_time]
  # NOTE: MAST uses MJD for start and end times in our cross-mission search. We can convert from datetime strings, but if they are included in the manifest separately it would eliminate the need to do the conversion on the MAST side.
  MJDSTART: # SOC Proposed
    title: Start Time MJD
    description: Observation start time in MJD
    type: number
    archive_catalog:
      datatype: float
      destination:
        [CGIExposure.visit_start_time_mjd, CGIMosaic.visit_start_time_mjd]
  MJDEND: # SOC Proposed
    title: End Time MJD
    description: Observation end time in MJD
    type: number
    archive_catalog:
      datatype: float
      destination:
        [CGIExposure.visit_end_time_mjd, CGIMosaic.visit_end_time_mjd]

required:
  [
    EXPTIME,
    ARRTYPE,
    HVCBIAS,
    EMGAIN_C,
    UNITYG,
    EMGAINA1,
    EMGAINA2,
    EMGAINA3,
    EMGAINA4,
    EMGAINA5,
    GAINTCAL,
    EMGAIN_A,
    KGAINPAR,
    CYCLES,
    LASTEXP,
    BLNKTIME,
    BLNKCYC,
    EXPCYC,
    ISPC,
    FTIMEUTC,
    OPMODE,
    EXPSTART,
    EXPEND,
    MJDSTART,
    MJDEND,
  ]
